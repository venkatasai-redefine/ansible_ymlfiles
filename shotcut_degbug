---
- name: Collect Uptime Debug Info
  hosts: all
  gather_facts: false # Uptime doesn't need facts

  tasks:
    - name: Get Uptime
      shell: uptime
      register: uptime_output

    - name: Create debug info directory (if needed)
      file:
        path: /tmp/debug_info
        state: directory
      delegate_to: localhost # Run only on the control node

    - name: Save Uptime to file
      copy:
        content: "{{ inventory_hostname }}:\n{{ uptime_output.stdout }}\n"
        dest: "/tmp/debug_info/{{ inventory_hostname }}_uptime.txt"
      delegate_to: localhost # Run only on the control node

    - name: Display uptime on the host
      debug:
        msg: "{{ inventory_hostname }}: {{ uptime_output.stdout }}"
